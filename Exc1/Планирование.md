# Планирование: анализ, идентификация проблем и поиск решений

## Анализ

### Текущее состояние
Вопросы:
1. новый заказ - по каким критериям заказ считается новым?
2. алгоритм "кто взял новый заказ тот и получит оплату" - может быть проблемой сценария, что приводит к проблемам обработки заказов
Глоссарий:
* Онлайн-магазин — написан на Vue и Java Spring Boot.
* CRM — SPA-приложение, фронтэнд написан на Vue, бэкенд — на Java Spring Boot.
* MES — SPA-приложение, фронтенд написан на React, бэкенд — на C#.
* SLA заказов - какой SLA? исходя из истори 2-3мин
* SLA API - какой SLA? предположим, что и как у заказов 2-3мин
* dev, release и prod. - контуры
* Internet Shop - магазин (далее - Shop)

Дисклеймеры:
1. ограничение производства -  2х кратный рост. Ограничение не учитывается в решении.

Начальное состояние: 
расчет стоимости 2-3мин (завист от кол-ва полигонов в 3д модели (размера?))

Изменение: 
1. рост - текущий год на 100 в мес больше чем в предыдущем, рост линейный
Проблемы: 
* SLA заказов (несколько месяцев вместо 3х недель). Производство справляется может обеспечит2х кратный рост. Проблема на стороне приклада.

2. открытие апи - бурный рост
Проблемы: 
* SLA заказов - Увеличение количества просроченных заказов
* SLA API - не получаеют заказы клиенты
* MES - долго прогружается страница с заказами
* SLA API - потеря клиентов за месяц использования

Требования:
1. MES - обеспечить быстрое отображение новых заказов (что такое новый заказ?)


Инфра:
1. сервис в облаке 
2. Приложение - 1 инстанс
3. БД - один истанс на сервис 

### Анализ схемы
1. нет систем мониторинга, не ясна нагрузка, ошибки, SLA запрос/ответ
2. нет балансировщиков - не ясна возможэность горизонтального масштабирования (и для MES и для CRM)
3. нет разщделение на Суб-домены - CRM и Shop смотрят в одну БД, что может свидетельствовать о монолитном решении  
4. MES API занимается длительной процедурой калькуляции - возможная проблема ответсвенности сервисов 
5. 1 инстанс на контейнер - монолит?
6. 

### Инициативы  

В порядке приоритета 1- наибольший приоритет
1. Определение проблемных зон - Мониторинг:
    1.1. Определение метрик для мониторинга и пороговые значения
    1.2. Разворачивание мониторинга и логирования 
    1.3. Настройка метрик и пороговых значений (включая дашборды и оповещения)
Результат: Выявление замедлений/длительных ответов/Наличия ошибок в конкретных сервисах
2. Определение причин - Логирование:
    2.1. Разворачивание логирвоания
    2.2. Модификация сервисов для указания запросов/ответов сквозных идентификаторов
    2.3. Настройка сбора и их анализ на предмет выявления проблем/ошибок
Результат: Определение причин проблем (включая "потерю" заказов)
3. Анализ результатов мониторинга и логирования, принятие решений по модификации приложения, включая приоритеты модификации
Цель: стабилизация текущего решения 
Результат: исключение потери заказов
4. Выработка целевого решения
Цель: достижение SLA, возможности роста
   

